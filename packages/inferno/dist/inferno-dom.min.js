!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):n.InfernoDOM=e()}(this,function(){"use strict";function n(n){return!u(n._e)}function e(n){return!u(n._component)}function t(n){return!u(n._async)}function o(n){return!u(n._dom)}function r(n){return!u(n._tag)}function l(n){return!u(n.bp)}function u(n){return void 0===n}function i(n){return u(n)||a(n)}function a(n){return null===n}function c(n){return u(n)||a(n)||m(n)}function f(n){return Array.isArray(n)}function s(n){return!u(n.then)}function d(n){return"string"==typeof n}function _(n){return"number"==typeof n}function m(n){return n===!1}function p(n){return n===!0}function v(n){return d(n)||_(n)}function h(n,e,t,o,r,l){for(var u=0;u<n.length;u++)y(n[u],e,t,o,r,l)}function y(n,o,l,u,i,a){f(n)?h(n,o,l,u,i,a):K(n)?k(n,o,i,a):t(n)?b(n,o,i,a):r(n)?w(n,o,l,u,i,a):e(n)&&g(n,o,l,u,i,a)}function g(n,e,t,o,r,l){var u=n._hooks,i=n._dom,a=n._isStateful,c=n._instance;p(a)?(y(c._lastInput,e,t,o,r,l),c.componentWillUnmount()):(y(c,e,t,o,r,l),u&&u.componentWillUnmount&&ln("componentWillUnmount",u.componentWillUnmount,i,t,null,null))}function w(n,e,t,o,r,l){var u=n._hooks,i=n._dom,c=n._tag;if(d(c)){u&&(u.willDetach&&ln("willDetach",u.willDetach,i,t,null,null),u.detached&&ln("detached",u.detached,i,t,null,null));var s=n._children;a(s)||(f(s)?h(s,i,t,o,!1,!1):v(s)||y(s,i,t,o,!1,!1));var _=n._ref;_&&o&&delete o.refs[_]}p(r)&&m(l)&&X(e,i)}function k(n,e,t,o){p(t)&&m(o)&&X(e,n._dom)}function b(n,e,t,o){n._cancel=!0,p(t)&&m(o)&&X(e,n._dom)}function E(o,u,i,c,s,d,_,m,p){if(n(u))n(o)?V(o,u):c.domNode===i?(y(o,i,c,s,m,!1),c.deleteRoot()):fn(o,u,i,c,s);else if(n(o))c.domNode===i?hn(u,i,c,s,d,!1,p):cn(o,u,i,c,s,d,_,p);else if(f(o))f(u)?_?M(o,u,i,c,s,d,p,m):A(o,u,i,c,s,d,m,p):dn(i,hn(u,null,c,s,d,_,p),o,c,s);else if(f(u))_n(o,u,i,c,s,d,_,p);else if(t(u))t(o)?S(o,u,i,c,s,d,_,m,p):j(o,u,i,c,s,d,_,m,p);else if(l(u));else if(r(u))r(o)?N(o,u,i,c,s,d,_,m,p):un(o,u,i,c,s,d,_,m,p);else if(e(u))e(o)?U(o,u,i,c,s,d,_,m,p):an(o,u,i,c,s,d,_,m,p);else if(t(o)){var v=o._lastInput;a(v)?mn(o,u,i,c,s,d,_,p):E(v,u,i,c,s,d,_,m,p)}else{if(!K(o))throw new Error(Cn);K(u)?C(o,u):sn(o,u,i,c,s,d,_,p)}}function U(n,e,t,o,r,l,u,i,c){var s=n._component,d=e._component,_=n._isStateful,m=e._isStateful,v=n._props,h=e._props;if(s===d)if(p(_)){if(p(m)){var y=n._instance,w=y._lastInput,k=Object.assign({},y.state),b=y.shouldComponentUpdate(h,k);if(b){var U=y.state,x=y._patchComponent(w,t,U,k,v,h,o,r,l,u,i,c);y._lastInput=x,e._instance=y,e._dom=x._dom}}}else if(p(m));else{var N=e._hooks,I=!a(N),V=n._instance,S=on(d(h)),j=!0;if(f(S))throw new Error(Mn);I&&N.componentShouldUpdate&&(j=N.componentShouldUpdate(n._dom,v,h)),p(j)?(I&&N.componentWillUpdate&&ln("componentWillUpdate",N.componentWillUpdate,n._dom,o,null,null),E(V,S,t,o,null,l,!1,!1,c),e._dom=S._dom,e._instance=S,I&&N.componentDidUpdate&&ln("componentDidUpdate",N.componentDidUpdate,e._dom,o,null,null)):(e._dom=V._dom,e._instance=V)}else{var A=wn(e,t,o,r,l,u,c);L(t,A,n._dom),g(n,t,o,r,!0,!0)}}function x(n,e,t,o,r){if(a(e))for(var l=Object.keys(n),i=0;i<l.length;i++){var c=l[i];t(c,null,r)}else if(a(n))for(var f=Object.keys(e),s=0;s<f.length;s++){var d=f[s];t(d,e[d],r)}else{for(var _=Object.keys(n),m=Object.keys(e),p=0;p<_.length;p++){var v=_[p];u(e[v])?t(v,null,r):o(v,n[v],e[v],r)}for(var h=0;h<m.length;h++){var y=m[h];u(n[y])&&t(y,e[y],r)}}}function N(n,e,t,o,r,l,u,i,c){var f=n._tag,s=e._tag,d=e._hooks,_=n._dom,p=n._isKeyed&&e._isKeyed||u;if(e._dom=_,f!==s)y(n,null,o,r,i,!0),L(t,hn(e,null,o,r,l,p,c),_);else{var v=n._text,h=e._text;if(l=Y(l,s),!a(d)&&d.willUpdate&&ln("willUpdate",d.willUpdate,_,o,null,null),v!==h)a(h)?H(null,_,!1):H(h,_,!a(v));else{var g=n._children,w=e._children;g!==w&&(a(g)?hn(w,_,o,r,l,p,c):(m(u)&&(w=e._children=on(w)),E(g,w,_,o,r,l,p,!0,c)))}var k=n._props,b=e._props;k!==b&&x(k,b,nn,T,_);var U=n._attrs,N=e._attrs;U!==N&&x(U,N,$,O,_);var V=n._events,S=e._events;V!==S&&x(V,S,z,W,_);var j=n._ref,A=e._ref;j!==A&&I(r,j,A,_),!a(d)&&d.didUpdate&&ln("didUpdate",d.didUpdate,_,o,null,null)}}function I(n,e,t,o){n&&(d(e)&&delete n.refs[e],d(t)&&(n.refs[t]=o))}function V(n,e){e._dom=n._dom}function S(n,e,t,o,r,l,u,i,c){var f=n._lastInput,d=e._async;a(f)?s(d)&&(n._cancel=!0,d.then(function(i){if(m(e._cancel)){i=on(i);var a=hn(i,null,o,r,l,u,c);L(t,a,n._dom),e._dom=a,e._lastInput=i}})):s(d)&&j(f,e,t,o,r,l,u,i,c)}function j(n,e,t,o,r,l,u,i,a){var c=e._async;c.then(function(c){m(e._cancel)&&(c=on(c),E(n,c,t,o,r,l,u,i,a),e._dom=rn(c,t),e._lastInput=c)})}function A(n,e,t,o,r,l,u,i){n=tn(n,!1),e=tn(e,!0);for(var a=n.length,c=e.length,f=a>c?c:a,s=0;f>s;s++)E(n[s],e[s],t,o,r,l,!1,u,i);if(c>a)for(s=f;c>s;s++)hn(e[s],t,o,r,l,!1,i);else if(a>c)for(s=f;a>s;s++)y(n[s],t,o,r,u,!1)}function C(n,e){var t=e._text,o=n._dom;e._dom=o,n._text!==t&&G(o,e._text)}function M(n,e,t,o,r,l,u,i){for(var a,c,f,s,d,_=n.length,m=e.length,p=_-1,v=m-1,h=0,g=0,w=null,k=null,b=null,U=null,x=0;p>=h&&v>=g&&(k=e[g],w=n[h],k._key===w._key);)E(w,k,t,o,r,l,!0,i,u),g++,h++;for(;p>=h&&v>=g&&(b=e[v],U=n[p],b._key===U._key);)E(U,b,t,o,r,l,!0,i,u),v--,p--;for(;p>=h&&v>=g&&(b=e[v],w=n[h],b._key===w._key);)f=m>v+1?e[v+1]._dom:null,E(w,b,t,o,r,l,!0,i,u),q(t,b._dom,f),v--,h++;for(;p>=h&&v>=g&&(k=e[g],U=n[p],k._key===U._key);)f=n[h]._dom,E(U,k,t,o,r,l,!0,i,u),q(t,k._dom,f),g++,p--;if(h>p){if(v>=g)for(f=m>v+1?e[v+1]._dom:null;v>=g;g++)q(t,hn(e[g],null,o,r,l,!0,u),f)}else if(g>v)for(;p>=h;)y(n[h++],t,o,r,i,!1);else{var N=p-h+1,I=v-g+1,V=new Array(I);for(a=0;I>a;a++)V[a]=-1;var S=!1,j=0;if(16>=N*I)for(a=h;p>=a;a++){var A=!0;for(U=n[a],c=g;v>=c;c++)if(b=e[c],U._key===b._key){V[c-g]=a,x>c?S=!0:x=c,E(U,b,t,o,r,l,!0,i,u),A=!1;break}A&&(y(U,t,o,r,i,!1),j++)}else{var C=new Map;for(a=g;v>=a;a++)d=e[a],C.set(d._key,a);for(a=p;a>=h;a--)U=n[a],c=C.get(U._key),void 0===c?(y(U,t,o,r,i,!1),j++):(b=e[c],V[c-g]=a,x>c?S=!0:x=c,E(U,b,t,o,r,l,!0,i,u))}if(S){var M=D(V);for(c=M.length-1,a=I-1;a>=0;a--)-1===V[a]?(s=a+g,f=m>s+1?e[s+1]._dom:null,q(t,hn(e[s],null,o,r,l,!0,u),f)):0>c||a!==M[c]?(s=a+g,f=m>s+1?e[s+1]._dom:null,q(t,e[s]._dom,f)):c--}else if(N-j!==I)for(a=I-1;a>=0;a--)-1===V[a]&&(s=a+g,f=m>s+1?e[s+1]._dom:null,q(t,hn(e[s],null,o,r,l,!0,u),f))}}function D(n){var e=n.slice(0),t=[];t.push(0);var o,r,l,u,i;for(o=0;o<n.length;o++)if(-1!==n[o])if(r=t[t.length-1],n[r]<n[o])e[o]=r,t.push(o);else{for(l=0,u=t.length-1;u>l;)i=(l+u)/2|0,n[t[i]]<n[o]?l=i+1:u=i;n[o]<n[t[l]]&&(l>0&&(e[o]=t[l-1]),t[l]=o)}for(l=t.length,u=t[l-1];l-- >0;)t[l]=u,u=e[u];return t}function O(n,e,t,o){e!==t&&$(n,t,o)}function W(n,e,t,o,r){e!==t&&z(n,t,o)}function T(n,e,t,o){e!==t&&("className"===n?a(t)?o.removeAttribute("class"):o.className=t:"style"===n?F(e,t,o):o[n]=t)}function F(n,e,t){if(d(e))t.style.cssText=e;else if(i(n)){if(!i(e))for(var o=Object.keys(e),r=0;r<o.length;r++){var l=o[r];t.style[l]=e[l]}}else if(i(e))t.removeAttribute("style");else{for(var a=Object.keys(e),c=0;c<a.length;c++){var f=a[c];t.style[f]=e[f]}if(!i(n))for(var s=Object.keys(n),_=0;_<s.length;_++){var m=s[_];u(e[m])&&(t.style[m]="")}}}function K(n){return!u(n._t)}function P(n){return!u(n.bp)}function R(){return J("")}function B(n,e){n.appendChild(e)}function L(n,e,t){n.replaceChild(e,t)}function X(n,e){n.removeChild(e)}function q(n,e,t){u(t)?n.appendChild(e):n.insertBefore(e,t)}function z(n,e,t){t[n]=e}function G(n,e){n.nodeValue=e}function H(n,e,t){t?G(e.firstChild,n):null===n?e.textContent="":""!==n?e.textContent=n:B(e,J(""))}function J(n){return document.createTextNode(n)}function Q(n,e){return e?document.createElementNS(e,n):document.createElement(n)}function Y(n,e){return n||"svg"!==e?n:Dn}function Z(n){return"xlink:"===n.substring(0,6)?"http://www.w3.org/1999/xlink":"xml:"===n.substring(0,4)?"http://www.w3.org/XML/1998/namespace":null}function $(n,e,t){var o=Z(n);c(e)?t.removeAttribute(n):o?t.setAttributeNS(o,n,e):t.setAttribute(n,e)}function nn(n,e,t){c(e)?"className"===n?t.removeAttribute("class"):"style"===n?t.removeAttribute("style"):t[n]="":"className"===n?t.className=e:"style"===n?F(null,e,t):t[n]=e}function en(n,e){for(var t=0;t<n.length;t++){var o=n[t];f(o)?en(o,e):c(o)||(v(o)?e.push(new Sn(o)):s(o)?e.push(new jn(o)):e.push(o))}}function tn(n,e){if(u(On.get(n))){if(!e){var t=[];return On.set(n,!0),en(n,t),t}var o=n.slice(0);On.set(n,!0),n.length=0,en(o,n)}return n}function on(n){return c(n)?new An:o(n)?n:v(n)?new Sn(n):s(n)?new jn(n):n}function rn(n,e){return u(n._dom)?f(n)?rn(n[0],e):void 0:n._dom}function ln(n,e,t,o,r,l){switch(n){case"attached":case"detached":case"componentDidMount":o.callback(function(){e(t)});break;default:return e(t,r,l)}}function un(n,e,t,o,r,l,u,i,a){var c=kn(e,null,o,r,l,a);L(t,c,rn(n,null)),y(n,t,o,r,i,!0)}function an(n,e,t,o,r,l,u,i,a){var c=wn(e,null,o,r,l,u,a);L(t,c,rn(n,null)),y(n,t,o,r,i,!0)}function cn(n,e,t,r,l,u,i,a){var f=n._dom;c(e)||o(e)||(e=on(e)),L(t,hn(e,null,r,l,u,i,a),f)}function fn(n,e,t,o,r){L(t,yn(e,null),rn(n,null))}function sn(n,e,t,r,l,u,i,a){var f=n._dom;c(e)||o(e)||(e=on(e)),L(t,hn(e,null,r,l,u,i,a),f)}function dn(n,e,t,o,r){var l=t[0];q(n,e,rn(l,null)),y(t,n,o,r,!0,!1)}function _n(n,e,t,o,r,l,u,i){L(t,hn(e,null,o,r,l,u,i),rn(n,null))}function mn(n,e,t,r,l,u,i,a){var f=n._dom;n._cancel=!0,c(e)||o(e)||(e=on(e)),L(t,hn(e,null,r,l,u,i,a),f)}function pn(){return document.activeElement}function vn(n){null!==n&&n!==document.body&&document.activeElement!==n&&n.focus()}function hn(o,l,u,i,c,s,d){if(n(o))return yn(o,l);if(K(o))return gn(o,l);if(e(o))return wn(o,l,u,i,c,s,d);if(r(o))return kn(o,l,u,i,c,d);if(P(o))return bn(o,l,u,i,d);if(t(o))return En(o,l,u,i,c,s,d);if(f(o)){var _=l;return a(l)&&(_=document.createDocumentFragment()),m(s)?Un(tn(o,!0),_,u,i,c,!1,d):Un(o,_,u,i,c,!0,d),_}throw v(o)?new Error('Inferno Error: invalid mount input of "'+typeof o+'". Ensure the String or Number is wrapped in a VElement, VComponent, VTemplate or Array.'):new Error('Inferno Error: failed to "mount", invalid object was detected. Valid "mount" types are Array, Promise, Function, VTextNode, VElement, VComponent, VAsyncNode and VTemplate.')}function yn(n,e){var t=R();return n._dom=t,a(e)||B(e,t),t}function gn(n,e){var t=J(n._text);return n._dom=t,a(e)||B(e,t),t}function wn(n,e,t,o,r,l,u){var i,c=n._isStateful,s=n._component,d=n._props;n._ref;if(p(c)){var _=new s(d),m=n._ref;_._patch=E,!a(o)&&m&&xn(o,m,_);var v=_.getChildContext();a(v)||(u=Object.assign({},u,v)),_._unmounted=!1,_._pendingSetState=!0,_.componentWillMount();var h=on(_.render());_._pendingSetState=!1,i=hn(h,e,t,_,r,l,u),_._lastInput=h,_.componentDidMount(),n._dom=i,n._instance=_}else{var y=n._hooks,g=on(s(d));if(f(g))throw new Error("Inferno Error: components cannot have an Array as a root input. Use String, Number, VElement, VComponent, VTemplate, Null or False instead.");i=hn(g,e,t,null,r,l,u),n._dom=i,n._instance=g,y&&(y.componentWillMount&&ln("componentWillMount",y.componentWillMount,i,t,null,null),y.componentDidMount&&ln("componentDidMount",y.componentDidMount,i,t,null,null))}return i}function kn(n,e,t,o,r,l){var u=n._tag;if(d(u)){r=Y(r,u);var i=Q(u,r),c=n._text,s=n._hooks;if(n._dom=i,s&&(s.created&&s.created(i),s.attached&&t.callback(function(){s.attached(i)})),a(c)){var _=n._children,p=n._isKeyed;a(_)||(f(_)?(m(p)&&(_=n._children=tn(_,!1)),Un(_,i,t,o,r,p,l)):(_=n._children=on(_),hn(_,i,t,o,r,p,l)))}else H(c,i,!1);var v=n._events;if(!a(v))for(var h=Object.keys(v),y=0;y<h.length;y++){var g=h[y],w=v[g];z(g,w,i)}var k=n._attrs;if(!a(k))for(var b=Object.keys(k),E=0;E<b.length;E++){var U=b[E],x=k[U];$(U,x,i)}var N=n._props;if(!a(N))for(var I=Object.keys(N),V=0;V<I.length;V++){var S=I[V],j=N[S];nn(S,j,i)}var A=n._ref;return a(A)||xn(o,A,i),a(e)||B(e,i),i}throw new Error("Inferno Error: expected a String for VElement tag type")}function bn(n,e,t,o,r){}function En(n,e,t,o,r,l,u){var i=n._async,c=R();return n._dom=c,s(i)&&i.then(function(i){if(m(n._cancel)){i=on(i);var a=hn(i,null,t,o,r,l,u);L(e||c.parentNode,a,c),n._dom=a,n._lastInput=i}}),a(e)||B(e,c),c}function Un(n,e,t,o,r,l,u){for(var i=0;i<n.length;i++){var a=n[i];hn(a,e,t,o,r,l,u)}}function xn(n,e,t){!c(n)&&d(e)&&(n.refs[e]=t)}function Nn(n,e){var t=Tn.get(e),o=new Wn(e);if(n=on(n),u(t))hn(n,e,o,null,null,!1,{}),t=new Fn(e,n);else{var r=pn();E(t.input,n,e,o,null,null,!1,!0,{}),t.input=n,vn(r)}o.trigger()}function In(n){return new Kn(null,null,null,null)}function Vn(n){return In(n)}var Sn=function(n){this._dom=null,this._key=null,this._t=null,this._text=n},jn=function(n){this._dom=null,this._key=null,this._cancel=!1,this._lastInput=null,this._async=n},An=function(){this._dom=null,this._key=null,this._e=null},Cn='Inferno Error: bad input(s) passed to "patch". Please ensure only valid objects are used in your render.',Mn="Inferno Error: components cannot have an Array as a root input. Use String, Number, VElement, VComponent, VTemplate, Null or False instead.",Dn="http://www.w3.org/2000/svg",On=new Map,Wn=function(n){this.domNode=n,this.callbacks=[]};Wn.prototype.callback=function n(n){this.callbacks.push(n)},Wn.prototype.trigger=function(){var n=this.callbacks,e=n.length;if(e>0)for(var t=0;e>t;t++)n[t]()},Wn.prototype.deleteRoot=function(){Tn.delete(this.domNode)};var Tn=new Map,Fn=function(n,e){this.input=e,Tn.set(n,this)},Kn=function(n,e,t,o){this._dom=null,this._key=e,this.bp=n,this.v0=t,this.v1=o},Pn={render:Nn,template:Vn};return Pn});