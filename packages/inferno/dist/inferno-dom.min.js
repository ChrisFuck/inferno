!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):n.InfernoDOM=t()}(this,function(){"use strict";function n(n){return!i(n._e)}function t(n){return!i(n._component)}function e(n){return!i(n._async)}function o(n){return!i(n._dom)}function r(n){return!i(n._tag)}function l(n){return!i(n.bp)}function i(n){return void 0===n}function u(n){return null===n}function a(n){return i(n)||u(n)||_(n)}function c(n){return Array.isArray(n)}function f(n){return!i(n.then)}function s(n){return"string"==typeof n}function d(n){return"number"==typeof n}function _(n){return n===!1}function p(n){return n===!0}function m(n){return s(n)||d(n)}function v(n,t,e,o,r,l){for(var i=0;i<n.length;i++)h(n[i],t,e,o,r,l)}function h(n,o,l,i,u,a){c(n)?v(n,o,l,i,u,a):T(n)?b(n,o,u,a):e(n)?w(n,o,u,a):r(n)?g(n,o,l,i,u,a):t(n)&&y(n,o,l,i,u,a)}function y(n,t,e,o,r,l){var i=n._hooks,u=n._dom,a=n._isStateful,c=n._instance;p(a)?(h(c._lastInput,t,e,o,r,l),c.componentWillUnmount()):(h(c,t,e,o,r,l),i&&i.componentWillUnmount&&tn("componentWillUnmount",i.componentWillUnmount,u,e,null,null))}function g(n,t,e,o,r,l){var i=n._hooks,a=n._dom,f=n._tag;if(s(f)){i&&(i.willDetach&&tn("willDetach",i.willDetach,a,e,null,null),i.detached&&tn("detached",i.detached,a,e,null,null));var d=n._children;u(d)||(c(d)?v(d,a,e,o,!1,!1):m(d)||h(d,a,e,o,!1,!1));var y=n._ref;y&&o&&delete o.refs[y]}p(r)&&_(l)&&B(t,a)}function b(n,t,e,o){p(e)&&_(o)&&B(t,n._dom)}function w(n,t,e,o){n._cancel=!0,p(e)&&_(o)&&B(t,n._dom)}function k(o,i,a,f,s,d,_,m){if(n(i))n(o)?x(o,i):p(m)?(h(o,a,f,s,m,!1),f.deleteRoot()):fn(i,null);else if(n(o))p(m)&&cn(i,a,f,s,d,!1);else if(c(o))c(i)?_?A(o,i,a,f,s,d):j(o,i,a,f,s,d,m):ln(a,cn(i,null,f,s,d,_),o,f,s);else if(c(i))un(o,i,a,f,s,d,_);else if(e(i))e(o)?I(o,i,a,f,s,d,_,m):V(o,i,a,f,s,d,_,m);else if(l(i));else if(r(i))r(o)?S(o,i,a,f,s,d,_,m):en(o,i,a,f,s,d,_,m);else if(t(i))t(o)?U(o,i,a,f,s,d,_,m):on(o,i,a,f,s,d,_,m);else if(e(o)){var v=o._lastInput;u(v)?an(o,i,a,f,s,d,_):k(v,i,a,f,s,d,_,m)}else{if(!T(o))throw new Error(En);T(i)?D(o,i):rn(o,i,a,f,s,d,_)}}function U(n,t,e,o,r,l,i,a){var f=n._component,s=t._component,d=n._isStateful,_=t._isStateful,m=n._props,v=t._props;if(f===s)if(p(d)){if(p(_)){var h=n._instance,g=h._lastInput,b=h.componentShouldUpdate();if(b){var w=h.state,U=Object.assign({},h.state);h._blockSetState=!0,h.componentWillUpdate(v,U),h._blockSetState=!1,h.props=v,h.state=U;var E=$(h.render());if(c(E))throw new Error(Sn);k(g,E,e,o,r,l,i,a),h.componentDidUpdate(m,w),h._lastInput=E,t._instance=h,t._dom=E._dom}}}else if(p(_));else{var S=t._hooks,N=!u(S),x=n._instance,I=$(s(v)),V=!0;if(c(I))throw new Error(Sn);N&&S.componentShouldUpdate&&(V=S.componentShouldUpdate(n._dom,m,v)),p(V)?(N&&S.componentWillUpdate&&tn("componentWillUpdate",S.componentWillUpdate,n._dom,o,null,null),k(x,I,e,o,null,l,!1,!1),t._dom=I._dom,t._instance=I,N&&S.componentDidUpdate&&tn("componentDidUpdate",S.componentDidUpdate,t._dom,o,null,null)):(t._dom=x._dom,t._instance=x)}else{var j=dn(t,e,o,r,l,i);R(e,j,n._dom),y(n,e,o,r,!0,!0)}}function E(n,t,e,o,r,l){if(u(t))for(var a=Object.keys(n),c=0;c<a.length;c++){var f=a[c];e(f,null,r)}else if(u(n))for(var s=Object.keys(t),d=0;d<s.length;d++){var _=s[d];e(_,t[_],r)}else{for(var p=Object.keys(n),m=Object.keys(t),v=0;v<p.length;v++){var h=p[v];i(t[h])?e(h,null,r,l):o(h,n[h],t[h],r,l)}for(var y=0;y<m.length;y++){var g=m[y];i(n[g])&&e(g,t[g],r,l)}}}function S(n,t,e,o,r,l,i,a){var c=n._tag,f=t._tag,s=t._hooks,d=n._dom,_=n._isKeyed&&t._isKeyed||i;if(t._dom=d,c!==f)h(n,null,o,r,a,!0),R(e,cn(t,null,o,r,l,_),d);else{var p=n._text,m=t._text;if(!u(s)&&s.willUpdate&&tn("willUpdate",s.willUpdate,d,o,null,null),p!==m)u(m)?H(null,d,!1):H(m,d,!u(p));else{var v=n._children,y=t._children;v!==y&&(v=$(v),y=$(y),k(v,y,d,o,r,l,_,!1))}var g=n._props,b=t._props;g!==b&&E(g,b,X,O,d,l);var w=n._attrs,U=t._attrs;w!==U&&E(w,U,Q,C,d,l);var S=n._events,x=t._events;S!==x&&E(S,x,z,M,d,l);var I=n._ref,V=t._ref;I!==V&&N(r,I,V,d),!u(s)&&s.didUpdate&&tn("didUpdate",s.didUpdate,d,o,null,null)}}function N(n,t,e,o){n&&(s(t)&&delete n.refs[t],s(e)&&(n.refs[e]=o))}function x(n,t){t._dom=n._dom}function I(n,t,e,o,r,l,i,a){var c=n._lastInput,s=t._async;u(c)?f(s)&&(n._cancel=!0,s.then(function(u){if(_(t._cancel)){u=$(u);var a=cn(u,null,o,r,l,i);R(e,a,n._dom),t._dom=a,t._lastInput=u}})):f(s)&&V(c,t,e,o,r,l,i,a)}function V(n,t,e,o,r,l,i,u){var a=t._async;a.then(function(a){_(t._cancel)&&(a=$(a),k(n,a,e,o,r,l,i,u),t._dom=nn(a,e),t._lastInput=a)})}function j(n,t,e,o,r,l,i){n=Z(n,!1),t=Z(t,!0);for(var u=n.length,a=t.length,c=u>a?a:u,f=0;c>f;f++)k(n[f],t[f],e,o,r,l,!1,i);if(a>u)for(f=c;a>f;f++)cn(t[f],e,o,r,l,!1);else if(u>a)for(f=c;u>f;f++)h(n[f],e,o,r,!0,!1)}function D(n,t){var e=t._text,o=n._dom;t._dom=o,n._text!==e&&G(o,t._text)}function A(n,t,e,o,r,l){}function C(n,t,e,o,r){t!==e&&Q(n,e,o,r)}function M(n,t,e,o,r){t!==e&&z(n,e,o)}function O(n,t,e,o){t!==e&&("className"===n?o.className=e:"style"===n?W(t,e,o):o[n]=e)}function W(n,t,e){if(s(t))e.style.cssText=t;else if(i(n)){if(!i(t))for(var o=Object.keys(t),r=0;r<o.length;r++){var l=o[r];e.style[l]=t[l]}}else if(i(t))e.removeAttribute("style");else{for(var u=Object.keys(t),a=0;a<u.length;a++){var c=u[a];e.style[c]=t[c]}for(var f=Object.keys(n),d=0;d<f.length;d++){var _=f[d];i(t[_])&&(e.style[_]="")}}}function T(n){return!i(n._t)}function F(n){return!i(n.bp)}function K(){return J("")}function P(n,t){n.appendChild(t)}function R(n,t,e){n.replaceChild(t,e)}function B(n,t){n.removeChild(t)}function q(n,t,e){i(e)?n.appendChild(t):n.insertBefore(t,e)}function z(n,t,e){e[n]=t}function G(n,t){n.nodeValue=t}function H(n,t,e){e?G(t.firstChild,n):null===n?t.textContent="":""!==n?t.textContent=n:P(t,J(""))}function J(n){return document.createTextNode(n)}function L(n,t){return t?document.createElementNS(t,n):document.createElement(n)}function Q(n,t,e,o){a(t)?e.removeAttribute(n):o?e.setAttributeNS(o,n,t):e.setAttribute(n,t)}function X(n,t,e){a(t)?"className"===n?e.removeAttribute("class"):"style"===n?e.removeAttribute("style"):e[n]="":"className"===n?e.className=t:"style"===n?W(null,t,e):e[n]=t}function Y(n,t){for(var e=0;e<n.length;e++){var o=n[e];c(o)?Y(o,t):a(o)||(m(o)?t.push(new wn(o)):f(o)?t.push(new kn(o)):t.push(o))}}function Z(n,t){if(i(Nn.get(n))){if(!t){var e=[];return Nn.set(n,!0),Y(n,e),e}var o=n.slice(0);Nn.set(n,!0),n.length=0,Y(o,n)}return n}function $(n){return a(n)?new Un:o(n)?n:m(n)?new wn(n):f(n)?new kn(n):n}function nn(n,t){return i(n._dom)?c(n)?nn(n[0],t):void 0:n._dom}function tn(n,t,e,o,r,l){switch(n){case"attached":case"detached":case"componentDidMount":o.callback(function(){t(e)});break;default:return t(e,r,l)}}function en(n,t,e,o,r,l,i,u){var a=_n(t,null,o,r,l);R(e,a,nn(n,null)),h(n,e,o,r,u,!0)}function on(n,t,e,o,r,l,i,u){var a=dn(t,null,o,r,l,i);R(e,a,nn(n,null)),h(n,e,o,r,u,!0)}function rn(n,t,e,r,l,i,u){var c=n._dom;a(t)||o(t)||(t=$(t)),R(e,cn(t,null,r,l,i,u),c)}function ln(n,t,e,o,r){var l=e[0];q(n,t,nn(l,null)),h(e,n,o,r,!0,!1)}function un(n,t,e,o,r,l,i){R(e,cn(t,null,o,r,l,i),nn(n,null))}function an(n,t,e,r,l,i,u){var c=n._dom;n._cancel=!0,a(t)||o(t)||(t=$(t)),R(e,cn(t,null,r,l,i,u),c)}function cn(o,l,i,a,f,s){if(n(o))return fn(o,l);if(T(o))return sn(o,l);if(t(o))return dn(o,l,i,a,f,s);if(r(o))return _n(o,l,i,a,f);if(F(o))return pn(o,l,i,a);if(e(o))return mn(o,l,i,a,f,s);if(c(o)){var d=l;return u(l)&&(d=document.createDocumentFragment()),_(s)?vn(Z(o,!0),d,i,a,f,!1):vn(o,d,i,a,f,!0),d}throw m(o)?new Error('Inferno Error: invalid mount input of "'+typeof o+'". Ensure the String or Number is wrapped in a VElement, VComponent, VTemplate or Array.'):new Error('Inferno Error: failed to "mount", invalid object was detected. Valid "mount" types are Array, Promise, Function, VTextNode, VElement, VComponent, VAsyncNode and VTemplate.')}function fn(n,t){var e=K();return n._dom=e,u(t)||P(t,e),e}function sn(n,t){var e=J(n._text);return n._dom=e,u(t)||P(t,e),e}function dn(n,t,e,o,r,l){var i,a=n._isStateful,f=n._component,s=n._props;n._ref;if(p(a)){var d=new f(s),_=n._ref;d._patch=k,!u(o)&&_&&hn(o,_,d);d.getChildContext();d._unmounted=!1,d._pendingSetState=!0,d.componentWillMount();var m=$(d.render());d._pendingSetState=!1,i=cn(m,t,e,d,r,l),d._lastInput=m,d.componentDidMount(),n._dom=i,n._instance=d}else{var v=n._hooks,h=$(f(s));if(c(h))throw new Error("Inferno Error: components cannot have an Array as a root input. Use String, Number, VElement, VComponent, VTemplate, Null or False instead.");i=cn(h,t,e,null,r,l),n._dom=i,n._instance=h,v&&(v.componentWillMount&&tn("componentWillMount",v.componentWillMount,i,e,null,null),v.componentDidMount&&tn("componentDidMount",v.componentDidMount,i,e,null,null))}return i}function _n(n,t,e,o,r){var l=n._tag;if(s(l)){var i=L(l,r),a=n._text,f=n._hooks;n._dom=i,f&&(f.created&&f.created(i),f.attached&&e.callback(function(){f.attached(i)})),a&&H(a,i,!1);var d=n._children,_=n._isKeyed;u(d)||(c(d)?(_||(d=n._children=Z(d,!1)),vn(d,i,e,o,r,_)):cn(d,i,e,o,r,_));var p=n._events;if(!u(p))for(var m=Object.keys(p),v=0;v<m.length;v++){var h=m[v],y=p[h];z(h,y,i)}var g=n._attrs;if(!u(g))for(var b=Object.keys(g),w=0;w<b.length;w++){var k=b[w],U=g[k];Q(k,U,i,r)}var E=n._props;if(!u(E))for(var S=Object.keys(E),N=0;N<S.length;N++){var x=S[N],I=E[x];X(x,I,i)}var V=n._ref;return u(V)||hn(o,V,i),u(t)||P(t,i),i}throw new Error("Inferno Error: expected a String for VElement tag type")}function pn(n,t,e,o){}function mn(n,t,e,o,r,l){var i=n._async,a=K();return n._dom=a,f(i)&&i.then(function(i){if(_(n._cancel)){i=$(i);var u=cn(i,null,e,o,r,l);R(t||a.parentNode,u,a),n._dom=u,n._lastInput=i}}),u(t)||P(t,a),a}function vn(n,t,e,o,r,l){for(var i=0;i<n.length;i++){var u=n[i];cn(u,t,e,o,r,l)}}function hn(n,t,e){!a(n)&&s(t)&&(n.refs[t]=e)}function yn(n,t){var e=In.get(t),o=new xn(t);n=$(n),i(e)?(cn(n,t,o,null,null,!1),e=new Vn(t,n)):(k(e.input,n,t,o,null,null,!1,!0),e.input=n),o.trigger()}function gn(n){return new jn(null,null,null,null)}function bn(n){return gn(n)}var wn=function(n){this._dom=null,this._key=null,this._t=null,this._text=n},kn=function(n){this._dom=null,this._key=null,this._cancel=!1,this._lastInput=null,this._async=n},Un=function(){this._dom=null,this._key=null,this._e=null},En='Inferno Error: bad input(s) passed to "patch". Please ensure only valid objects are used in your render.',Sn="Inferno Error: components cannot have an Array as a root input. Use String, Number, VElement, VComponent, VTemplate, Null or False instead.",Nn=new Map,xn=function(n){this.domNode=n,this.callbacks=[]};xn.prototype.callback=function n(n){this.callbacks.push(n)},xn.prototype.trigger=function(){var n=this.callbacks,t=n.length;if(t>0)for(var e=0;t>e;e++)n[e]()},xn.prototype.deleteRoot=function(){In.delete(this.domNode)};var In=new Map,Vn=function(n,t){this.input=t,In.set(n,this)},jn=function(n,t,e,o){this._dom=null,this._key=t,this.bp=n,this.v0=e,this.v1=o},Dn={render:yn,template:bn};return Dn});